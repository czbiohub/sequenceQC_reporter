---
title: "Sequence QC Reporter Tool: Map well-to-well quality metrics"
output:
  prettydoc::html_pretty:
    theme: cayman
---

```{r, echo=FALSE}
library(knitr)
opts_chunk$set(fig.align = "center", echo=FALSE, out.width = '70%')
```

#####Load R libraries
```{r, warning = FALSE, message = FALSE}
lbry = c("tidyverse", "stringr", "viridis", "gridExtra", "grid")
#lapply(lbry, install.packages, character.only=TRUE)
lapply(lbry, require, character.only=TRUE)
```

####Import `sequenceQC_reporter_functions.R` to your project directory
```{r, warning = FALSE, message = FALSE}
setwd('~/sequenceQC_reporter/')
source('sequenceQC_reporter_functions.R')
```

####Your working directory should look like this 
```{r, out.width = '60%', fig.cap="Example of project working directory"}
knitr::include_graphics("/Users/foad.green/sequenceQC_reporter/examplewd.png")
```

####Try getting your FASTQ data for "PF Clusters"
Current output for `getyour_FASTQ_data` function:
* Dataframe used to map plates (saved to pwd as .csv)
* Platemap for passed-filter clusters (log2scale; saved as .png)
* Platemap for passed-filter clusters (unscaled; saved as .png)
```{r, eval = FALSE, warning = FALSE, message = FALSE}
PROJECT_DIR = "~/data/runs"
FASTQ_data = getyour_FASTQ_data(PROJECT_DIR)
```

####Here are some example platemaps from `getyour_FASTQ_data` functionthat will be saved to your project directory
```{r, out.width = '60%', fig.cap="Example of log2-scale and unscaled platemaps for PF Clusters"}
knitr::include_graphics("/Users/foad.green/data/runs/171215_M05295_0067_000000000-BHWTV/171215_M05295_0067_000000000-BHWTV_PASSED-FILTER Clusters_miseq_bcl2fastqreport_log2heatmap.png")
knitr::include_graphics("/Users/foad.green/data/runs/171215_M05295_0067_000000000-BHWTV/171215_M05295_0067_000000000-BHWTV_PASSED-FILTER Clusters_miseq_bcl2fastqreport_heatmap.png")
```


####Try getting your STAR data from a `log.final.out` file
* Number of input reads = line6
* Uniquely mapped reads % = line10
* Insertion average length = line22

```{r, out.width = '60%', fig.cap="Example of logfinalout file"}
knitr::include_graphics("/Users/foad.green/sequenceQC_reporter/example_logfinalout.png")
```

Current output for `getyour_STAR_data` function:
* Dataframe used to map plates (saved to pwd as .csv)
* Platemap for `YOUR_PARAMETER` (log2scale; saved as .png)
* Grid arrangement of platemaps for all selections in `YOUR_PARAMETER`
```{r, eval = FALSE, warning = FALSE, message = FALSE}
PROJECT_DIR = "~/data/runs"
YOUR_PARAMETER = c(6, 10, 22)
STAR_DATA = getyour_STAR_data(PROJECT_DIR, YOUR_PARAMETER)
```


####Here are some platemaps for `YOUR_PARAMETER` from `getyour_STAR_data` function. This is saved to your project directory
```{r, out.width = '60%', fig.cap="Example of platemaps from `getyour_STAR_data` function"}
knitr::include_graphics("/Users/foad.green/data/runs/171215_M05295_0067_000000000-BHWTV/171215_M05295_0067_000000000-BHWTV_14_STARreport_log2heatmap.png")
knitr::include_graphics("/Users/foad.green/data/runs/171215_M05295_0067_000000000-BHWTV/171215_M05295_0067_000000000-BHWTV_15_STARreport_log2heatmap.png")
knitr::include_graphics("/Users/foad.green/data/runs/171215_M05295_0067_000000000-BHWTV/171215_M05295_0067_000000000-BHWTV_16_STARreport_log2heatmap.png")
knitr::include_graphics("/Users/foad.green/data/runs/171215_M05295_0067_000000000-BHWTV/171215_M05295_0067_000000000-BHWTV_ALL_PARAMETERS_STARreport_log2heatmap.png")
```




